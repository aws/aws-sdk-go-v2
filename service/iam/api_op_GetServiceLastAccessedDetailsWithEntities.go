// Code generated by private/model/cli/gen-api/main.go. DO NOT EDIT.

package iam

import (
	"context"

	"github.com/aws/aws-sdk-go-v2/aws"
	"github.com/aws/aws-sdk-go-v2/service/iam/types"
)

const opGetServiceLastAccessedDetailsWithEntities = "GetServiceLastAccessedDetailsWithEntities"

// GetServiceLastAccessedDetailsWithEntitiesRequest returns a request value for making API operation for
// AWS Identity and Access Management.
//
// After you generate a group or policy report using the GenerateServiceLastAccessedDetails
// operation, you can use the JobId parameter in GetServiceLastAccessedDetailsWithEntities.
// This operation retrieves the status of your report job and a list of entities
// that could have used group or policy permissions to access the specified
// service.
//
//    * Group – For a group report, this operation returns a list of users
//    in the group that could have used the group’s policies in an attempt
//    to access the service.
//
//    * Policy – For a policy report, this operation returns a list of entities
//    (users or roles) that could have used the policy in an attempt to access
//    the service.
//
// You can also use this operation for user or role reports to retrieve details
// about those entities.
//
// If the operation fails, the GetServiceLastAccessedDetailsWithEntities operation
// returns the reason that it failed.
//
// By default, the list of associated entities is sorted by date, with the most
// recent access listed first.
//
//    // Example sending a request using GetServiceLastAccessedDetailsWithEntitiesRequest.
//    req := client.GetServiceLastAccessedDetailsWithEntitiesRequest(params)
//    resp, err := req.Send(context.TODO())
//    if err == nil {
//        fmt.Println(resp)
//    }
//
// Please also see https://docs.aws.amazon.com/goto/WebAPI/iam-2010-05-08/GetServiceLastAccessedDetailsWithEntities
func (c *Client) GetServiceLastAccessedDetailsWithEntitiesRequest(input *types.GetServiceLastAccessedDetailsWithEntitiesInput) GetServiceLastAccessedDetailsWithEntitiesRequest {
	op := &aws.Operation{
		Name:       opGetServiceLastAccessedDetailsWithEntities,
		HTTPMethod: "POST",
		HTTPPath:   "/",
	}

	if input == nil {
		input = &types.GetServiceLastAccessedDetailsWithEntitiesInput{}
	}

	req := c.newRequest(op, input, &types.GetServiceLastAccessedDetailsWithEntitiesOutput{})
	return GetServiceLastAccessedDetailsWithEntitiesRequest{Request: req, Input: input, Copy: c.GetServiceLastAccessedDetailsWithEntitiesRequest}
}

// GetServiceLastAccessedDetailsWithEntitiesRequest is the request type for the
// GetServiceLastAccessedDetailsWithEntities API operation.
type GetServiceLastAccessedDetailsWithEntitiesRequest struct {
	*aws.Request
	Input *types.GetServiceLastAccessedDetailsWithEntitiesInput
	Copy  func(*types.GetServiceLastAccessedDetailsWithEntitiesInput) GetServiceLastAccessedDetailsWithEntitiesRequest
}

// Send marshals and sends the GetServiceLastAccessedDetailsWithEntities API request.
func (r GetServiceLastAccessedDetailsWithEntitiesRequest) Send(ctx context.Context) (*GetServiceLastAccessedDetailsWithEntitiesResponse, error) {
	r.Request.SetContext(ctx)
	err := r.Request.Send()
	if err != nil {
		return nil, err
	}

	resp := &GetServiceLastAccessedDetailsWithEntitiesResponse{
		GetServiceLastAccessedDetailsWithEntitiesOutput: r.Request.Data.(*types.GetServiceLastAccessedDetailsWithEntitiesOutput),
		response: &aws.Response{Request: r.Request},
	}

	return resp, nil
}

// GetServiceLastAccessedDetailsWithEntitiesResponse is the response type for the
// GetServiceLastAccessedDetailsWithEntities API operation.
type GetServiceLastAccessedDetailsWithEntitiesResponse struct {
	*types.GetServiceLastAccessedDetailsWithEntitiesOutput

	response *aws.Response
}

// SDKResponseMetdata returns the response metadata for the
// GetServiceLastAccessedDetailsWithEntities request.
func (r *GetServiceLastAccessedDetailsWithEntitiesResponse) SDKResponseMetdata() *aws.Response {
	return r.response
}
