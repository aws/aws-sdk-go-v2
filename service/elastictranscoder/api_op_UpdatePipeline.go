// Code generated by smithy-go-codegen DO NOT EDIT.

package elastictranscoder

import (
	"context"
	awsmiddleware "github.com/aws/aws-sdk-go-v2/aws/middleware"
	"github.com/aws/aws-sdk-go-v2/aws/retry"
	"github.com/aws/aws-sdk-go-v2/aws/signer/v4"
	"github.com/aws/aws-sdk-go-v2/service/elastictranscoder/types"
	smithy "github.com/awslabs/smithy-go"
	"github.com/awslabs/smithy-go/middleware"
	smithyhttp "github.com/awslabs/smithy-go/transport/http"
)

// Use the UpdatePipeline operation to update settings for a pipeline. When you
// change pipeline settings, your changes take effect immediately. Jobs that you
// have already submitted and that Elastic Transcoder has not started to process
// are affected in addition to jobs that you submit after you change settings.
func (c *Client) UpdatePipeline(ctx context.Context, params *UpdatePipelineInput, optFns ...func(*Options)) (*UpdatePipelineOutput, error) {
	stack := middleware.NewStack("UpdatePipeline", smithyhttp.NewStackRequest)
	options := c.options.Copy()
	for _, fn := range optFns {
		fn(&options)
	}
	addawsRestjson1_serdeOpUpdatePipelineMiddlewares(stack)
	awsmiddleware.AddRequestInvocationIDMiddleware(stack)
	smithyhttp.AddContentLengthMiddleware(stack)
	AddResolveEndpointMiddleware(stack, options)
	v4.AddComputePayloadSHA256Middleware(stack)
	retry.AddRetryMiddlewares(stack, options)
	addHTTPSignerV4Middleware(stack, options)
	awsmiddleware.AddAttemptClockSkewMiddleware(stack)
	addClientUserAgent(stack)
	smithyhttp.AddErrorCloseResponseBodyMiddleware(stack)
	smithyhttp.AddCloseResponseBodyMiddleware(stack)
	addOpUpdatePipelineValidationMiddleware(stack)
	stack.Initialize.Add(newServiceMetadataMiddleware_opUpdatePipeline(options.Region), middleware.Before)

	for _, fn := range options.APIOptions {
		if err := fn(stack); err != nil {
			return nil, err
		}
	}
	handler := middleware.DecorateHandler(smithyhttp.NewClientHandler(options.HTTPClient), stack)
	result, metadata, err := handler.Handle(ctx, params)
	if err != nil {
		return nil, &smithy.OperationError{
			ServiceID:     ServiceID,
			OperationName: "UpdatePipeline",
			Err:           err,
		}
	}
	out := result.(*UpdatePipelineOutput)
	out.ResultMetadata = metadata
	return out, nil
}

// The UpdatePipelineRequest structure.
type UpdatePipelineInput struct {
	// The ID of the pipeline that you want to update.
	Id *string
	// The AWS Key Management Service (AWS KMS) key that you want to use with this
	// pipeline. If you use either s3 or s3-aws-kms as your Encryption:Mode, you don't
	// need to provide a key with your job because a default key, known as an AWS-KMS
	// key, is created for you automatically. You need to provide an AWS-KMS key only
	// if you want to use a non-default AWS-KMS key, or if you are using an
	// Encryption:Mode of aes-cbc-pkcs7, aes-ctr, or aes-gcm.
	AwsKmsKeyArn *string
	// The ThumbnailConfig object specifies several values, including the Amazon S3
	// bucket in which you want Elastic Transcoder to save thumbnail files, which users
	// you want to have access to the files, the type of access you want users to have,
	// and the storage class that you want to assign to the files. If you specify
	// values for ContentConfig, you must also specify values for ThumbnailConfig even
	// if you don't want to create thumbnails. If you specify values for ContentConfig
	// and ThumbnailConfig, omit the OutputBucket object.
	//
	//     * Bucket: The Amazon S3
	// bucket in which you want Elastic Transcoder to save thumbnail files.
	//
	//     *
	// Permissions (Optional): The Permissions object specifies which users and/or
	// predefined Amazon S3 groups you want to have access to thumbnail files, and the
	// type of access you want them to have. You can grant permissions to a maximum of
	// 30 users and/or predefined Amazon S3 groups.
	//
	//     * GranteeType: Specify the
	// type of value that appears in the Grantee object:
	//
	//         * Canonical: The
	// value in the Grantee object is either the canonical user ID for an AWS account
	// or an origin access identity for an Amazon CloudFront distribution. A canonical
	// user ID is not the same as an AWS account number.
	//
	//         * Email: The value in
	// the Grantee object is the registered email address of an AWS account.
	//
	//         *
	// Group: The value in the Grantee object is one of the following predefined Amazon
	// S3 groups: AllUsers, AuthenticatedUsers, or LogDelivery.
	//
	//     * Grantee: The AWS
	// user or group that you want to have access to thumbnail files. To identify the
	// user or group, you can specify the canonical user ID for an AWS account, an
	// origin access identity for a CloudFront distribution, the registered email
	// address of an AWS account, or a predefined Amazon S3 group.
	//
	//     * Access: The
	// permission that you want to give to the AWS user that you specified in Grantee.
	// Permissions are granted on the thumbnail files that Elastic Transcoder adds to
	// the bucket. Valid values include:
	//
	//         * READ: The grantee can read the
	// thumbnails and metadata for objects that Elastic Transcoder adds to the Amazon
	// S3 bucket.
	//
	//         * READ_ACP: The grantee can read the object ACL for
	// thumbnails that Elastic Transcoder adds to the Amazon S3 bucket.
	//
	//         *
	// WRITE_ACP: The grantee can write the ACL for the thumbnails that Elastic
	// Transcoder adds to the Amazon S3 bucket.
	//
	//         * FULL_CONTROL: The grantee
	// has READ, READ_ACP, and WRITE_ACP permissions for the thumbnails that Elastic
	// Transcoder adds to the Amazon S3 bucket.
	//
	//     * StorageClass: The Amazon S3
	// storage class, Standard or ReducedRedundancy, that you want Elastic Transcoder
	// to assign to the thumbnails that it stores in your Amazon S3 bucket.
	ThumbnailConfig *types.PipelineOutputConfig
	// The topic ARN for the Amazon Simple Notification Service (Amazon SNS) topic that
	// you want to notify to report job status. To receive notifications, you must also
	// subscribe to the new topic in the Amazon SNS console.
	//
	//     * Progressing: The
	// topic ARN for the Amazon Simple Notification Service (Amazon SNS) topic that you
	// want to notify when Elastic Transcoder has started to process jobs that are
	// added to this pipeline. This is the ARN that Amazon SNS returned when you
	// created the topic.
	//
	//     * Complete: The topic ARN for the Amazon SNS topic that
	// you want to notify when Elastic Transcoder has finished processing a job. This
	// is the ARN that Amazon SNS returned when you created the topic.
	//
	//     * Warning:
	// The topic ARN for the Amazon SNS topic that you want to notify when Elastic
	// Transcoder encounters a warning condition. This is the ARN that Amazon SNS
	// returned when you created the topic.
	//
	//     * Error: The topic ARN for the Amazon
	// SNS topic that you want to notify when Elastic Transcoder encounters an error
	// condition. This is the ARN that Amazon SNS returned when you created the topic.
	Notifications *types.Notifications
	// The Amazon S3 bucket in which you saved the media files that you want to
	// transcode and the graphics that you want to use as watermarks.
	InputBucket *string
	// The optional ContentConfig object specifies information about the Amazon S3
	// bucket in which you want Elastic Transcoder to save transcoded files and
	// playlists: which bucket to use, which users you want to have access to the
	// files, the type of access you want users to have, and the storage class that you
	// want to assign to the files. If you specify values for ContentConfig, you must
	// also specify values for ThumbnailConfig. If you specify values for ContentConfig
	// and ThumbnailConfig, omit the OutputBucket object.
	//
	//     * Bucket: The Amazon S3
	// bucket in which you want Elastic Transcoder to save transcoded files and
	// playlists.
	//
	//     * Permissions (Optional): The Permissions object specifies which
	// users you want to have access to transcoded files and the type of access you
	// want them to have. You can grant permissions to a maximum of 30 users and/or
	// predefined Amazon S3 groups.
	//
	//     * Grantee Type: Specify the type of value that
	// appears in the Grantee object:
	//
	//         * Canonical: The value in the Grantee
	// object is either the canonical user ID for an AWS account or an origin access
	// identity for an Amazon CloudFront distribution. For more information about
	// canonical user IDs, see Access Control List (ACL) Overview in the Amazon Simple
	// Storage Service Developer Guide. For more information about using CloudFront
	// origin access identities to require that users use CloudFront URLs instead of
	// Amazon S3 URLs, see Using an Origin Access Identity to Restrict Access to Your
	// Amazon S3 Content. A canonical user ID is not the same as an AWS account
	// number.
	//
	//         * Email: The value in the Grantee object is the registered
	// email address of an AWS account.
	//
	//         * Group: The value in the Grantee
	// object is one of the following predefined Amazon S3 groups: AllUsers,
	// AuthenticatedUsers, or LogDelivery.
	//
	//     * Grantee: The AWS user or group that
	// you want to have access to transcoded files and playlists. To identify the user
	// or group, you can specify the canonical user ID for an AWS account, an origin
	// access identity for a CloudFront distribution, the registered email address of
	// an AWS account, or a predefined Amazon S3 group
	//
	//     * Access: The permission
	// that you want to give to the AWS user that you specified in Grantee. Permissions
	// are granted on the files that Elastic Transcoder adds to the bucket, including
	// playlists and video files. Valid values include:
	//
	//         * READ: The grantee
	// can read the objects and metadata for objects that Elastic Transcoder adds to
	// the Amazon S3 bucket.
	//
	//         * READ_ACP: The grantee can read the object ACL
	// for objects that Elastic Transcoder adds to the Amazon S3 bucket.
	//
	//         *
	// WRITE_ACP: The grantee can write the ACL for the objects that Elastic Transcoder
	// adds to the Amazon S3 bucket.
	//
	//         * FULL_CONTROL: The grantee has READ,
	// READ_ACP, and WRITE_ACP permissions for the objects that Elastic Transcoder adds
	// to the Amazon S3 bucket.
	//
	//     * StorageClass: The Amazon S3 storage class,
	// Standard or ReducedRedundancy, that you want Elastic Transcoder to assign to the
	// video files and playlists that it stores in your Amazon S3 bucket.
	ContentConfig *types.PipelineOutputConfig
	// The name of the pipeline. We recommend that the name be unique within the AWS
	// account, but uniqueness is not enforced. Constraints: Maximum 40 characters
	Name *string
	// The IAM Amazon Resource Name (ARN) for the role that you want Elastic Transcoder
	// to use to transcode jobs for this pipeline.
	Role *string
}

// When you update a pipeline, Elastic Transcoder returns the values that you
// specified in the request.
type UpdatePipelineOutput struct {
	// Elastic Transcoder returns a warning if the resources used by your pipeline are
	// not in the same region as the pipeline. Using resources in the same region, such
	// as your Amazon S3 buckets, Amazon SNS notification topics, and AWS KMS key,
	// reduces processing time and prevents cross-regional charges.
	Warnings []*types.Warning
	// The pipeline updated by this UpdatePipelineResponse call.
	Pipeline *types.Pipeline

	// Metadata pertaining to the operation's result.
	ResultMetadata middleware.Metadata
}

func addawsRestjson1_serdeOpUpdatePipelineMiddlewares(stack *middleware.Stack) {
	stack.Serialize.Add(&awsRestjson1_serializeOpUpdatePipeline{}, middleware.After)
	stack.Deserialize.Add(&awsRestjson1_deserializeOpUpdatePipeline{}, middleware.After)
}

func newServiceMetadataMiddleware_opUpdatePipeline(region string) awsmiddleware.RegisterServiceMetadata {
	return awsmiddleware.RegisterServiceMetadata{
		Region:        region,
		ServiceID:     ServiceID,
		SigningName:   "elastictranscoder",
		OperationName: "UpdatePipeline",
	}
}
