// Code generated by endpoint/awsrulesfn/internal/partition. DO NOT EDIT.

package awsrulesfn

import (
	"fmt"
	"regexp"

	"github.com/aws/smithy-go/ptr"
)

// Partition provides the metadata describing an AWS partition.
type Partition struct {
	Name               string
	DnsSuffix          string
	DualStackDnsSuffix string
	SupportsFIPS       bool
	SupportsDualStack  bool
}

// GetPartition returns an AWS [Partition] for the region provided. If the
// partition cannot be determined nil will be returned.
func GetPartition(region string) *Partition {
	if v, ok := regionPartition[region]; ok {
		p, ok := partitions[v.PartitionID]
		if !ok {
			panic(fmt.Sprintf(
				"bad codegen, unable to get region looked up partition %v from partitions map",
				v.PartitionID))
		}
		p.mergeWith(v.Metadata)
		return &p
	}

	for _, r := range regionRegexps {
		if r.RegionRegex.MatchString(region) {
			p, ok := partitions[r.PartitionID]
			if !ok {
				panic(fmt.Sprintf(
					"bad codegen, unable to get region regexp looked up partition %v from partitions map",
					r.PartitionID))
			}
			return &p
		}
	}

	p, ok := partitions[defaultPartition]
	if !ok {
		panic(fmt.Sprintf(
			"bad codegen, unable to get default partition %v from partitions map",
			defaultPartition))
	}

	return &p
}

func (p *Partition) mergeWith(other partitionMetadata) {
	if vv := other.Name; vv != nil {
		p.Name = *vv
	}
	if vv := other.DnsSuffix; vv != nil {
		p.DnsSuffix = *vv
	}
	if vv := other.DualStackDnsSuffix; vv != nil {
		p.DualStackDnsSuffix = *vv
	}
	if vv := other.SupportsFIPS; vv != nil {
		p.SupportsFIPS = *vv
	}
	if vv := other.SupportsDualStack; vv != nil {
		p.SupportsDualStack = *vv
	}
}

const defaultPartition = "aws"

var partitions = map[string]Partition{
	"aws": {
		Name:               "aws",
		DnsSuffix:          "amazonaws.com",
		DualStackDnsSuffix: "api.aws",
		SupportsFIPS:       true,
		SupportsDualStack:  true,
	},
	"aws-cn": {
		Name:               "aws-cn",
		DnsSuffix:          "amazonaws.com.cn",
		DualStackDnsSuffix: "api.amazonwebservices.com.cn",
		SupportsFIPS:       true,
		SupportsDualStack:  true,
	},
}

type partitionMetadata struct {
	Name               *string
	DnsSuffix          *string
	DualStackDnsSuffix *string
	SupportsFIPS       *bool
	SupportsDualStack  *bool
}

var regionPartition = map[string]struct {
	PartitionID string
	Metadata    partitionMetadata
}{
	"aws-global": {
		PartitionID: "aws",
		Metadata: partitionMetadata{
			Name:               nil,
			DnsSuffix:          nil,
			DualStackDnsSuffix: nil,
			SupportsFIPS:       nil,
			SupportsDualStack:  nil,
		},
	},
	"us-east-1": {
		PartitionID: "aws",
		Metadata: partitionMetadata{
			Name:               nil,
			DnsSuffix:          nil,
			DualStackDnsSuffix: nil,
			SupportsFIPS:       nil,
			SupportsDualStack:  nil,
		},
	},
	"us-skip-1": {
		PartitionID: "aws",
		Metadata: partitionMetadata{
			Name:               ptr.String("aws"),
			DnsSuffix:          ptr.String("other.amazonaws.com"),
			DualStackDnsSuffix: ptr.String("other.api.aws"),
			SupportsFIPS:       ptr.Bool(false),
			SupportsDualStack:  ptr.Bool(false),
		},
	},
	"aws-cn-global": {
		PartitionID: "aws-cn",
		Metadata: partitionMetadata{
			Name:               nil,
			DnsSuffix:          nil,
			DualStackDnsSuffix: nil,
			SupportsFIPS:       nil,
			SupportsDualStack:  nil,
		},
	},
	"cn-north-5": {
		PartitionID: "aws-cn",
		Metadata: partitionMetadata{
			Name:               nil,
			DnsSuffix:          nil,
			DualStackDnsSuffix: nil,
			SupportsFIPS:       nil,
			SupportsDualStack:  nil,
		},
	},
}

var regionRegexps = []struct {
	PartitionID string
	RegionRegex *regexp.Regexp
}{
	{
		PartitionID: "aws",
		RegionRegex: regexp.MustCompile("^(us|eu|ap|sa|ca|me|af)-\\w+-\\d+$"),
	},
	{
		PartitionID: "aws-cn",
		RegionRegex: regexp.MustCompile("^(cn)-\\w+-\\d+$"),
	},
}
