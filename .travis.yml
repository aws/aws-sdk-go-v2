language: go
sudo: true
dist: bionic

os:
    - linux
go:
    - 1.13.x
    - 1.14.x
    - tip

matrix:
    allow_failures:
        - go: tip

script:
    make ci-test;

# Unable to enable Smithy SDK build automation because smithy-go is not published.
matrix:
  include:
    - language: java
      jdk: openjdk8
      before_script:
          - rm -rf /tmp/smithy-go
          - git clone https://github.com/awslabs/smithy-go /tmp/smithy-go
          - pushd /tmp/smithy-go/codegen
          - ./gradlew clean publishToMavenLocal -Plog-tests
          - popd
      script:
          - make smithy-generate # generation is not stable ci-test-generate-validate

    - language: java
      jdk: openjdk11
      before_script:
          - rm -rf /tmp/smithy-go
          - git clone https://github.com/awslabs/smithy-go /tmp/smithy-go
          - pushd /tmp/smithy-go/codegen
          - ./gradlew clean publishToMavenLocal -Plog-tests
          - popd
      script:
          - make smithy-generate # generation is not stable ci-test-generate-validate

